!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.MCPBankH5Bridge=o():e.MCPBankH5Bridge=o()}(self,(function(){return(()=>{"use strict";var e={};(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);const o="NO_ASK",t="android",n=()=>{let e="";return e=/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"iOS":/(Android)/i.test(navigator.userAgent)?t:"web",e};window.WebBridge={};let s=0;class a{static on(e,o){window[e]=o}static off(e){delete window[e]}static getCallbackId(){return"JSBRIDGE_CALLBACK_0_"+s++}}let i=(e,o,t=!1)=>{a.on(e,((n={})=>{o&&o(n),t||a.off(e)}))};class r{static call(e){let{moduleName:o,featureName:s,methodName:r,requestData:c,responseCallback:l}=e;if(!(o&&s&&r&&l))throw new Error("param is invalid");if(n()==t){if("function"==typeof l){const o=a.getCallbackId();e.callbackId=o,i(o,l,c)}else"string"==typeof l&&(e.callbackId=l,i(l,window[l],c));e.callbackId&&(e.responseCallback=e.callbackId);try{window.SPDBHybrid.callNativeMethod(JSON.stringify(e))}catch(e){console.error(e)}}else"iOS"==n()?window.WebViewJavascriptBridge.callHandler("callNativeMethod",e,l):console.error("No Platform Params is ",e)}static register(e,o,t=!1){a.on(e,o,t)}static unregister(e){a.off(e)}static handleCommonCallback(e,o){const{success:t,fail:n,complete:s,...a}=o;e.requestData=a,e.responseCallback=e=>{"mpaas_success"===e.responseCode?t&&t(e.responseData||{}):n&&n(e),s&&s(e)},r.call(e)}}return window.pf={},window.pf.getLocation=async function(e){try{await(t="LOCATION",new Promise((async(e,n)=>{try{await(s=t,new Promise(((e,o)=>{const t={permissionIds:[s],success:function(t){const n=t;"true"===n[s]||!0===n[s]?e({errCode:1,errMsg:"已授权"}):o({errCode:2,errMsg:"无权限"})},fail:function(e){console.log("checkPermissions fail",JSON.stringify(e)),o({errCode:0,errMsg:"权限检查失败"})},complete:function(e){console.log("checkPermissions complete",JSON.stringify(e))}};r.handleCommonCallback({moduleName:"permission",featureName:"managePermission",methodName:"checkPermissions"},t)}))),e(1)}catch(s){try{await(e=>new Promise(((t,n)=>{const s={permissionIds:[e],success:function(s){const a=s;"PERMISSION_GRANTED"==a[e]?t({errCode:1,errMsg:"获取权限成功"}):a[e]==o?confirm("当前暂无相关权限，是否前往设置进行授权？")?(()=>{const e={success:function(e){console.log("goAppSettings success",JSON.stringify(e))},fail:function(e){console.log("goAppSettings fail",JSON.stringify(e))},complete:function(e){console.log("goAppSettings complete",JSON.stringify(e))}};r.handleCommonCallback({moduleName:"permission",featureName:"managePermission",methodName:"goAppSettings"},e)})():n({errCode:3,errMsg:"获取权限失败：NO_ASK"}):n({errCode:2,errMsg:"获取权限失败：PERMISSION_DENIED"})},fail:function(e){console.log("requestPermission fail",JSON.stringify(e)),n({errCode:0,errMsg:"获取权限失败"})},complete:function(e){console.log("requestPermission complete",JSON.stringify(e))}};r.handleCommonCallback({moduleName:"permission",featureName:"managePermission",methodName:"requestPermissions"},s)})))(t),e(1)}catch(e){n(e)}}var s})))}catch(o){return void(e&&e.fail&&e.fail({responseCode:o.errCode,errorMsg:o.errMsg}))}var t;r.handleCommonCallback({moduleName:"basic",featureName:"location",methodName:"getLocation"},e)},window.pf.toastTest=function(e){r.handleCommonCallback({moduleName:"UI",featureName:"Toast",methodName:"show"},e)},window.pf.getToken=function(e){r.handleCommonCallback({moduleName:"UserInfo",featureName:"Token",methodName:"getToken"},e)},e})()}));